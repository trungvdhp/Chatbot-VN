C:\ProgramData\Miniconda3\Scripts>python D:\Chatbot-VN\chatbot-vn\chatbot.py --mode train
Data ready!
Bucketing conversation number 9999
Bucketing conversation number 19999
Bucketing conversation number 9999
Bucketing conversation number 19999
Bucketing conversation number 29999
Bucketing conversation number 39999
Bucketing conversation number 49999
Number of samples in each bucket:
 [53399]
Bucket scale:
 [1.0]
Initialize new model
Create placeholders
Create inference
Creating loss...
It might take a couple of minutes depending on how many buckets you have.
Time: 3.7261404991149902
Create optimizer...
It might take a couple of minutes depending on how many buckets you have.
Creating opt for bucket 0 took 9.445972442626953 seconds
Running session
Initializing fresh parameters for the Chatbot
Iter 30: loss 7.615609661738078, time 1.4375762939453125
Iter 60: loss 6.076650269826254, time 1.7188403606414795
Iter 90: loss 5.272959343592325, time 1.4688284397125244
Iter 200: loss 5.445154147148132, time 1.468825101852417
Iter 300: loss 4.7797968244552616, time 1.4688262939453125
Iter 400: loss 4.6977111339569095, time 1.437577724456787
Iter 500: loss 4.657936906814575, time 1.4532012939453125
Iter 600: loss 4.636785764694213, time 1.4688222408294678
Iter 700: loss 4.612345714569091, time 1.4531993865966797
Iter 800: loss 4.583374643325806, time 1.4219512939453125
Iter 900: loss 4.582467827796936, time 1.4531967639923096
Iter 1000: loss 4.570662937164307, time 1.453197956085205
Test bucket 0: loss 4.507087707519531, time 0.7031614780426025
Iter 1100: loss 4.559351830482483, time 1.453202486038208
Iter 1200: loss 4.556813378334045, time 1.4688222408294678
Iter 1300: loss 4.55094437122345, time 1.4688236713409424
Iter 1400: loss 4.522842693328857, time 1.4375686645507812
Iter 1500: loss 4.526983227729797, time 1.4375662803649902
Iter 1600: loss 4.505775384902954, time 1.4532020092010498
Iter 1700: loss 4.514419946670532, time 1.4375722408294678
Iter 1800: loss 4.5014752006530765, time 1.4375760555267334
Iter 1900: loss 4.507616472244263, time 1.45320463180542
Iter 2000: loss 4.486028962135315, time 1.4219560623168945
Test bucket 0: loss 4.514650344848633, time 0.37502002716064453
Iter 2100: loss 4.505935616493225, time 1.453202486038208
Iter 2200: loss 4.4827665424346925, time 1.4531939029693604
Iter 2300: loss 4.483157353401184, time 1.437570333480835
Iter 2400: loss 4.470691304206849, time 1.4375684261322021
Iter 2500: loss 4.469170126914978, time 1.4532091617584229
Iter 2600: loss 4.463628993034363, time 1.4219574928283691
Iter 2700: loss 4.4689892435073855, time 1.437577486038208
Iter 2800: loss 4.471248078346252, time 1.468820333480835
Iter 2900: loss 4.469399013519287, time 1.4219484329223633
Iter 3000: loss 4.4528494071960445, time 1.4219472408294678
Test bucket 0: loss 4.418771743774414, time 0.35939526557922363
Iter 3100: loss 4.45766583442688, time 1.4375758171081543
Iter 3200: loss 4.431780228614807, time 1.4375762939453125
Iter 3300: loss 4.395558686256408, time 1.4532082080841064
Iter 3400: loss 4.369206924438476, time 1.453195571899414
Iter 3500: loss 4.331623549461365, time 1.4219567775726318
Iter 3600: loss 4.30291494846344, time 1.4688234329223633
Iter 3700: loss 4.290091009140014, time 1.4375689029693604
Iter 3800: loss 4.290790848731994, time 1.4375746250152588
Iter 3900: loss 4.270519132614136, time 1.4688241481781006
Iter 4000: loss 4.2572178506851195, time 1.4532051086425781
Test bucket 0: loss 4.317800045013428, time 0.35939502716064453
Iter 4100: loss 4.268423972129821, time 1.437565565109253
Iter 4200: loss 4.254556140899658, time 1.4375755786895752
Iter 4300: loss 4.23738135099411, time 1.4532020092010498
Iter 4400: loss 4.209209003448486, time 1.4375767707824707
Iter 4500: loss 4.200924532413483, time 1.4375677108764648
Iter 4600: loss 4.1878166055679324, time 1.4375801086425781
Iter 4700: loss 4.153918952941894, time 1.4688303470611572
Iter 4800: loss 4.141130039691925, time 1.4375708103179932
Iter 4900: loss 4.118685367107392, time 1.437577247619629
Iter 5000: loss 4.106856241226196, time 1.4532020092010498
Test bucket 0: loss 4.313275337219238, time 0.35939502716064453
Iter 5100: loss 4.094522354602813, time 1.437570333480835
Iter 5200: loss 4.068393547534942, time 1.4219517707824707
Iter 5300: loss 4.056433417797089, time 1.4375805854797363
Iter 5400: loss 4.05837373495102, time 1.4532010555267334
Iter 5500: loss 4.03836909532547, time 1.4375839233398438
Iter 5600: loss 4.028728988170624, time 1.437575101852417
Iter 5700: loss 4.00604612827301, time 1.4219536781311035
Iter 5800: loss 4.009500560760498, time 1.4375784397125244
Iter 5900: loss 3.9719080924987793, time 1.4219460487365723
Iter 6000: loss 3.947489936351776, time 1.453199863433838
Test bucket 0: loss 4.029999256134033, time 0.37502193450927734
Iter 6100: loss 3.9348674035072326, time 1.4375767707824707
Iter 6200: loss 3.948290777206421, time 1.4375712871551514
Iter 6300: loss 3.9104715251922606, time 1.4219458103179932
Iter 6400: loss 3.9190569806098936, time 1.4375789165496826
Iter 6500: loss 3.8915605306625367, time 1.4219508171081543
Iter 6600: loss 3.8989372634887696, time 1.421940565109253
Iter 6700: loss 3.897654581069946, time 1.4375691413879395
Iter 6800: loss 3.8716597509384156, time 1.421950340270996
Iter 6900: loss 3.862618365287781, time 1.421949863433838
Iter 7000: loss 3.839260265827179, time 1.4519007205963135
Test bucket 0: loss 3.923604965209961, time 0.35939455032348633
Iter 7100: loss 3.835563142299652, time 1.4063217639923096
Iter 7200: loss 3.812248022556305, time 1.421947717666626
Iter 7300: loss 3.793517732620239, time 1.4532017707824707
Iter 7400: loss 3.799293780326843, time 1.42195463180542
Iter 7500: loss 3.7745717477798464, time 1.4219465255737305
Iter 7600: loss 3.761068720817566, time 1.4063284397125244
Iter 7700: loss 3.7659796905517577, time 1.4219417572021484
Iter 7800: loss 3.741959457397461, time 1.4375746250152588
Iter 7900: loss 3.72528258562088, time 1.4375765323638916
Iter 8000: loss 3.7086258220672605, time 1.4375762939453125
Test bucket 0: loss 4.047846794128418, time 0.3750193119049072
Iter 8100: loss 3.7004852390289305, time 1.4219486713409424
Iter 8200: loss 3.6579917097091674, time 1.491767406463623
Iter 8300: loss 3.661735589504242, time 1.4375760555267334
Iter 8400: loss 3.675153057575226, time 1.42195463180542
Iter 8500: loss 3.6508315634727477, time 1.4063303470611572
Iter 8600: loss 3.646558926105499, time 1.4532036781311035
Iter 8700: loss 3.63120584487915, time 1.4219465255737305
Iter 8800: loss 3.5952319860458375, time 1.437572717666626
Iter 8900: loss 3.602230632305145, time 1.4219534397125244
Iter 9000: loss 3.5874210810661316, time 1.421947956085205
Test bucket 0: loss 3.797476053237915, time 0.3593943119049072
Iter 9100: loss 3.5861081981658938, time 1.4219515323638916
Iter 9200: loss 3.5607886695861817, time 1.421952247619629
Iter 9300: loss 3.5519215512275695, time 1.4063210487365723
Iter 9400: loss 3.523627293109894, time 1.4375770092010498
Iter 9500: loss 3.517698974609375, time 1.4219577312469482
Iter 9600: loss 3.5186514186859132, time 1.4219541549682617
Iter 9700: loss 3.477354085445404, time 1.4219536781311035
Iter 9800: loss 3.492577176094055, time 1.4219450950622559
Iter 9900: loss 3.4488189220428467, time 1.4219512939453125
Iter 10000: loss 3.4394589829444886, time 1.4219560623168945
Test bucket 0: loss 3.953395366668701, time 0.37502050399780273
Iter 10100: loss 3.4544363379478455, time 1.4219555854797363
Iter 10200: loss 3.4213302636146548, time 1.4219403266906738
Iter 10300: loss 3.3994701957702635, time 1.4375858306884766
Iter 10400: loss 3.407325038909912, time 1.4398245811462402
Iter 10500: loss 3.3581056880950926, time 1.4219439029693604
Iter 10600: loss 3.3733200311660765, time 1.4219472408294678
Iter 10700: loss 3.3559085512161255, time 1.421945571899414
Iter 10800: loss 3.3382080364227296, time 1.4375801086425781
Iter 10900: loss 3.334962067604065, time 1.4219472408294678
Iter 11000: loss 3.2923118233680726, time 1.4219493865966797
Test bucket 0: loss 3.763558864593506, time 0.37501978874206543
Iter 11100: loss 3.286704783439636, time 1.4219467639923096
Iter 11200: loss 3.271491680145264, time 1.4219467639923096
Iter 11300: loss 3.2471949553489683, time 1.4375841617584229
Iter 11400: loss 3.240611162185669, time 1.4186811447143555
Iter 11500: loss 3.2294434404373167, time 1.4219496250152588
Iter 11600: loss 3.2128802800178526, time 1.4367907047271729
Iter 11700: loss 3.1816550970077513, time 1.4844586849212646
Iter 11800: loss 3.1712322211265564, time 1.437572717666626
Iter 11900: loss 3.14975293636322, time 1.4219517707824707
Iter 12000: loss 3.1560529494285583, time 1.4375791549682617
Test bucket 0: loss 4.088828086853027, time 0.35939455032348633
Iter 12100: loss 3.1468908619880676, time 1.4219486713409424
Iter 12200: loss 3.105020515918732, time 1.4219460487365723
Iter 12300: loss 3.093381905555725, time 1.4219424724578857
Iter 12400: loss 3.0800376963615417, time 1.4219553470611572
Iter 12500: loss 3.05666223526001, time 1.4375755786895752
Iter 12600: loss 3.062152440547943, time 1.4375741481781006
Iter 12700: loss 3.024757294654846, time 1.4219465255737305
Iter 12800: loss 3.002554519176483, time 1.4375710487365723
Iter 12900: loss 3.000868604183197, time 1.421952486038208
Iter 13000: loss 2.9841310143470765, time 1.4219484329223633
Test bucket 0: loss 4.3899149894714355, time 0.35939455032348633
Iter 13100: loss 2.9558328127861024, time 1.437575101852417
Iter 13200: loss 2.978462462425232, time 1.437584400177002
Iter 13300: loss 2.9230565214157105, time 1.4603362083435059
Iter 13400: loss 2.910173201560974, time 1.4748506546020508
Iter 13500: loss 2.8903416752815247, time 1.4219486713409424
Iter 13600: loss 2.899290816783905, time 1.4219450950622559
Iter 13700: loss 2.850048460960388, time 1.4063231945037842
Iter 13800: loss 2.8442318344116213, time 1.421952247619629
Iter 13900: loss 2.844943675994873, time 1.4219586849212646
Iter 14000: loss 2.8233157896995547, time 1.4375746250152588
Test bucket 0: loss 4.135595798492432, time 0.375018835067749
Iter 14100: loss 2.8133342552185057, time 1.4375767707824707
Iter 14200: loss 2.789751510620117, time 1.4219486713409424
Iter 14300: loss 2.784152615070343, time 1.4375717639923096
Iter 14400: loss 2.7461313104629514, time 1.4219505786895752
Iter 14500: loss 2.7258996081352236, time 1.4219563007354736
Iter 14600: loss 2.723715777397156, time 1.4219446182250977
Iter 14700: loss 2.727987880706787, time 1.4375765323638916
Iter 14800: loss 2.672870213985443, time 1.4375858306884766
Iter 14900: loss 2.690549783706665, time 1.4532015323638916
Iter 15000: loss 2.6799850916862487, time 1.406324863433838
Test bucket 0: loss 4.314373970031738, time 0.35939478874206543
Iter 15100: loss 2.629605004787445, time 1.4219505786895752
Iter 15200: loss 2.641766209602356, time 1.4219458103179932
Iter 15300: loss 2.6257573699951173, time 1.4063215255737305
Iter 15400: loss 2.5959167075157166, time 1.4219448566436768
Iter 15500: loss 2.5621202421188354, time 1.421954870223999
Iter 15600: loss 2.550821053981781, time 1.4219505786895752
Iter 15700: loss 2.5855352902412414, time 1.421949863433838
Iter 15800: loss 2.5516202592849733, time 1.4531991481781006
Iter 15900: loss 2.498045561313629, time 1.5157010555267334
Iter 16000: loss 2.525429723262787, time 1.4375712871551514
Test bucket 0: loss 4.569025039672852, time 0.368408203125
Iter 16100: loss 2.516146285533905, time 1.421952724456787
Iter 16200: loss 2.482236993312836, time 1.421954870223999
Iter 16300: loss 2.4654279017448424, time 1.4219493865966797
Iter 16400: loss 2.4490915298461915, time 1.4531984329223633
Iter 16500: loss 2.4245060300827026, time 1.421945571899414
Iter 16600: loss 2.4562890005111693, time 1.4219520092010498
Iter 16700: loss 2.4313028383255006, time 1.4063160419464111
Iter 16800: loss 2.421683118343353, time 1.4469504356384277
Iter 16900: loss 2.4054918932914733, time 1.421952486038208
Iter 17000: loss 2.3894401717185976, time 1.4219486713409424
Test bucket 0: loss 5.0259199142456055, time 0.35939550399780273
Iter 17100: loss 2.3685089600086213, time 1.4219567775726318
Iter 17200: loss 2.3442688369750977, time 1.42195463180542
Iter 17300: loss 2.3371419525146484, time 1.42195463180542
Iter 17400: loss 2.330485249757767, time 1.4219532012939453
Iter 17500: loss 2.3243130946159365, time 1.4219486713409424
Iter 17600: loss 2.312750436067581, time 1.4219517707824707
Iter 17700: loss 2.2885712385177612, time 1.4375755786895752
Iter 17800: loss 2.3152117526531217, time 1.421945333480835
Iter 17900: loss 2.2830273973941804, time 1.421950101852417
Iter 18000: loss 2.2939080774784086, time 1.4375712871551514
Test bucket 0: loss 4.745785236358643, time 0.35939455032348633
Iter 18100: loss 2.285514917373657, time 1.421945571899414
Iter 18200: loss 2.2520080828666686, time 1.406322717666626
Iter 18300: loss 2.286808911561966, time 1.4219508171081543
Iter 18400: loss 2.2248715364933016, time 1.4219486713409424
Iter 18500: loss 2.233441284894943, time 1.4685792922973633
Iter 18600: loss 2.2201673460006712, time 1.4219560623168945
Iter 18700: loss 2.2004438078403474, time 1.4375827312469482
Iter 18800: loss 2.2046509265899656, time 1.437572956085205
Iter 18900: loss 2.1960890603065493, time 1.4219439029693604
Iter 19000: loss 2.176450036764145, time 1.4375784397125244
Test bucket 0: loss 4.631872653961182, time 0.35939455032348633
Iter 19100: loss 2.1992911434173585, time 1.4063234329223633
Iter 19200: loss 2.174178982973099, time 1.4219520092010498
Iter 19300: loss 2.1673314106464385, time 1.4063186645507812
Iter 19400: loss 2.136652488708496, time 1.4375755786895752
Iter 19500: loss 2.1436703205108643, time 1.4219484329223633
Iter 19600: loss 2.152640024423599, time 1.4375817775726318
Iter 19700: loss 2.1379203057289122, time 1.4219439029693604
Iter 19800: loss 2.1291339945793153, time 1.4219486713409424
Iter 19900: loss 2.1154625070095063, time 1.421947717666626
Iter 20000: loss 2.1098728358745573, time 1.4063267707824707
Test bucket 0: loss 5.4376091957092285, time 0.3593924045562744
Iter 20100: loss 2.101485866308212, time 1.4063260555267334
Iter 20200: loss 2.0816844260692595, time 1.4219486713409424
Iter 20300: loss 2.10163170337677, time 1.4219532012939453
Iter 20400: loss 2.0444099855422975, time 1.4219567775726318
Iter 20500: loss 2.07425185084343, time 1.4219520092010498
Iter 20600: loss 2.0948333597183226, time 1.4219517707824707
Iter 20700: loss 2.0459501802921296, time 1.421952724456787
Iter 20800: loss 2.0219076716899873, time 1.421954870223999
Iter 20900: loss 2.0353408551216123, time 1.4219493865966797
Iter 21000: loss 2.0692044460773467, time 1.421947717666626
Test bucket 0: loss 4.726794242858887, time 0.3593943119049072
Iter 21100: loss 2.0687171256542207, time 1.4532074928283691
Iter 21200: loss 2.0132007324695587, time 1.4219436645507812
Iter 21300: loss 2.0104197323322297, time 1.421947717666626
Iter 21400: loss 2.035450738668442, time 1.4375808238983154
Iter 21500: loss 2.0243794751167297, time 1.4219422340393066
Iter 21600: loss 2.021781922578812, time 1.4219472408294678
Iter 21700: loss 2.0177250611782074, time 1.4219489097595215
Iter 21800: loss 1.9907929730415344, time 1.4219379425048828
Iter 21900: loss 1.9990475404262542, time 1.437586784362793
Iter 22000: loss 2.00605988740921, time 1.421949863433838
Test bucket 0: loss 5.0849409103393555, time 0.35939526557922363
Iter 22100: loss 2.008632307052612, time 1.4219517707824707
Iter 22200: loss 1.9972219717502595, time 1.4219441413879395
Iter 22300: loss 1.9707204508781433, time 1.421950340270996
Iter 22400: loss 1.980412392616272, time 1.4329092502593994
Iter 22500: loss 1.9904312872886658, time 1.437567949295044
Iter 22600: loss 1.9387791931629181, time 1.4375746250152588
Iter 22700: loss 1.9559093129634857, time 1.4531912803649902
Iter 22800: loss 1.9606151139736177, time 1.4531972408294678
Iter 22900: loss 1.9444645237922669, time 1.45320463180542
Iter 23000: loss 1.9595397675037385, time 1.4219512939453125
Test bucket 0: loss 5.201347351074219, time 0.35939502716064453
Iter 23100: loss 1.9402221858501434, time 1.421947956085205
Iter 23200: loss 1.9475599431991577, time 1.4219505786895752
Iter 23300: loss 1.9360959827899933, time 1.451643943786621
Iter 23400: loss 1.9472199428081511, time 1.4219553470611572
Iter 23500: loss 1.9017259323596953, time 1.4219534397125244
Iter 23600: loss 1.907611528635025, time 1.4219446182250977
Iter 23700: loss 1.9483192157745362, time 1.4063217639923096
Iter 23800: loss 1.9282398056983947, time 1.4219567775726318
Iter 23900: loss 1.9277751004695893, time 1.4219493865966797
Iter 24000: loss 1.9256608772277832, time 1.4219493865966797
Test bucket 0: loss 5.321549415588379, time 0.35939455032348633
Iter 24100: loss 1.9269660186767579, time 1.4375760555267334
Iter 24200: loss 1.9006994092464446, time 1.4375760555267334
Iter 24300: loss 1.8937994158267974, time 1.4219460487365723
Iter 24400: loss 1.888233754634857, time 1.4532067775726318
Iter 24500: loss 1.894417266845703, time 1.4375789165496826
Iter 24600: loss 1.8987258243560792, time 1.42195725440979
Iter 24700: loss 1.8929353964328766, time 1.4375755786895752
Iter 24800: loss 1.8896482169628144, time 1.4219553470611572
Iter 24900: loss 1.9143654954433442, time 1.4375805854797363
Iter 25000: loss 1.8869513082504272, time 1.4219517707824707
Test bucket 0: loss 5.2094926834106445, time 0.3750185966491699
Iter 25100: loss 1.8736460673809052, time 1.4219553470611572
Iter 25200: loss 1.8846092855930328, time 1.4375789165496826
Iter 25300: loss 1.9151782262325288, time 1.4375786781311035
Iter 25400: loss 1.8673957753181458, time 1.4375689029693604
Iter 25500: loss 1.8790245306491853, time 1.437574863433838
Iter 25600: loss 1.8968500423431396, time 1.4219493865966797
Iter 25700: loss 1.8389978837966918, time 1.4532032012939453
Iter 25800: loss 1.8497802138328552, time 1.4219491481781006
Iter 25900: loss 1.8516162025928498, time 1.437582015991211
Iter 26000: loss 1.8368216943740845, time 1.437575101852417
Test bucket 0: loss 5.428342819213867, time 0.37502050399780273
Iter 26100: loss 1.8485617196559907, time 1.4219486713409424
Iter 26200: loss 1.858017669916153, time 1.4375636577606201
Iter 26300: loss 1.8419185316562652, time 1.421952247619629
Iter 26400: loss 1.8579943430423738, time 1.4219491481781006
Iter 26500: loss 1.8472165060043335, time 1.4168314933776855
Iter 26600: loss 1.8504033398628235, time 1.4063172340393066
Iter 26700: loss 1.8648952174186706, time 1.4375786781311035
Iter 26800: loss 1.8501914620399476, time 1.4375808238983154
Iter 26900: loss 1.835797575712204, time 1.4375734329223633
Iter 27000: loss 1.848072509765625, time 1.421945571899414
Test bucket 0: loss 5.457242012023926, time 0.3593931198120117
Iter 27100: loss 1.8520313251018523, time 1.437574863433838
Iter 27200: loss 1.8385923683643342, time 1.437579870223999
Iter 27300: loss 1.8526016247272492, time 1.437570333480835
Iter 27400: loss 1.8285234344005585, time 1.4219412803649902
Iter 27500: loss 1.8447985649108887, time 1.4375762939453125
Iter 27600: loss 1.8487883043289184, time 1.437567949295044
Iter 27700: loss 1.8473852479457855, time 1.421957015991211
Iter 27800: loss 1.8606637740135192, time 1.4219493865966797
Iter 27900: loss 1.8280873537063598, time 1.4532008171081543
Iter 28000: loss 1.8332900953292848, time 1.4237043857574463
Test bucket 0: loss 5.303943157196045, time 0.3750190734863281
Iter 28100: loss 1.8154553723335267, time 1.4219403266906738
Iter 28200: loss 1.8130215680599213, time 1.4063231945037842
Iter 28300: loss 1.8302744734287262, time 1.4219567775726318
Iter 28400: loss 1.8170432424545289, time 1.4219474792480469
Iter 28500: loss 1.795377367734909, time 1.4375813007354736
Iter 28600: loss 1.8121913468837738, time 1.4375715255737305
Iter 28700: loss 1.8311092400550841, time 1.4219398498535156
Iter 28800: loss 1.8470392370223998, time 1.4063231945037842
Iter 28900: loss 1.8090433549880982, time 1.4219393730163574
Iter 29000: loss 1.8061138987541199, time 1.421943187713623
Test bucket 0: loss 5.290359973907471, time 0.35939455032348633
Iter 29100: loss 1.8233872950077057, time 1.4219543933868408
Iter 29200: loss 1.7900073432922363, time 1.42195463180542
Iter 29300: loss 1.7783134508132934, time 1.4531948566436768
Iter 29400: loss 1.816434872150421, time 1.42195463180542
Iter 29500: loss 1.7889250421524048, time 1.4375786781311035
Iter 29600: loss 1.7893231344223022, time 1.4219529628753662
Iter 29700: loss 1.812042704820633, time 1.446136713027954
Iter 29800: loss 1.7877982151508331, time 1.4219508171081543
Iter 29900: loss 1.8075425350666046, time 1.437577486038208
Iter 30000: loss 1.81280721783638, time 1.4219510555267334
Test bucket 0: loss 5.728172779083252, time 0.35939502716064453